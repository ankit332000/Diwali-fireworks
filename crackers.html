<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>Happy Diwali ðŸŽ†</title>
<style>
  html, body {
    margin: 0;
    height: 100%;
    overflow: hidden;
    background: radial-gradient(ellipse at bottom, #00111a 0%, #000814 60%, #000010 100%);
    font-family: "Poppins", sans-serif;
    touch-action: manipulation; /* prevents double-tap zoom */
  }

  canvas {
    display: block;
    width: 100%;
    height: 100%;
  }

  /* ðŸŽ‡ Main Title */
  .title {
    position: absolute;
    top: 45%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #ffd700;
    font-size: clamp(2rem, 8vw, 4rem);
    font-weight: 800;
    text-align: center;
    letter-spacing: 3px;
    text-shadow:
      0 0 8px #ffea80,
      0 0 16px #ffc400,
      0 0 24px #ff9900;
    animation: glow 2s ease-in-out infinite alternate;
    user-select: none;
    pointer-events: none;
  }

  @keyframes glow {
    from { text-shadow: 0 0 8px #ffd966, 0 0 16px #ffb347, 0 0 24px #ff9933; }
    to   { text-shadow: 0 0 16px #fff2b0, 0 0 32px #ffcc00, 0 0 48px #ff6600; }
  }

  /* âœ¨ Pulse when user clicks */
  .pulse {
    animation: pulse 0.8s ease-out;
  }

  @keyframes pulse {
    0%   { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    50%  { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
  }

  .hint {
    position: fixed;
    left: 12px;
    bottom: 12px;
    background: rgba(0,0,0,0.35);
    padding: 8px 12px;
    border-radius: 10px;
    font-size: 13px;
    color: #fff;
    backdrop-filter: blur(4px);
  }
</style>
</head>
<body>
<canvas id="c"></canvas>

<div class="title" id="title">HAPPY DIWALI</div>
<div class="hint">ðŸ’¥ Tap anywhere to shoot fireworks!</div>

<script>
(() => {
  const canvas = document.getElementById('c');
  const ctx = canvas.getContext('2d');
  let W = canvas.width = innerWidth;
  let H = canvas.height = innerHeight;
  const rockets = [], particles = [], lightning = [];
  const GRAVITY = 0.06, WIND = 0.002;
  const title = document.getElementById('title');

  function rand(a,b){return Math.random()*(b-a)+a}
  function randInt(a,b){return Math.floor(rand(a,b+1))}

  class Rocket {
    constructor(x,hue){
      this.x=x;this.y=H+10;this.vx=rand(-0.4,0.4);this.vy=rand(-6.5,-9.5);
      this.hue=hue??randInt(0,360);this.trail=[];this.alive=true;
      this.explodeAt=rand(H*0.25,H*0.55);
    }
    step(){
      this.trail.push({x:this.x,y:this.y});if(this.trail.length>10)this.trail.shift();
      this.vx+=WIND*rand(-1,1);this.vy+=GRAVITY*0.15;
      this.x+=this.vx;this.y+=this.vy;
      if(this.vy>=0||this.y<=this.explodeAt){this.explode();this.alive=false;}
    }
    draw(ctx){
      ctx.save();ctx.globalCompositeOperation='lighter';
      for(let i=0;i<this.trail.length;i++){
        const p=this.trail[i],a=(i+1)/this.trail.length;
        ctx.fillStyle=`hsla(${this.hue},100%,60%,${a})`;
        ctx.beginPath();ctx.arc(p.x,p.y,2*a,0,Math.PI*2);ctx.fill();
      }
      ctx.beginPath();ctx.fillStyle=`hsl(${this.hue},100%,70%)`;
      ctx.arc(this.x,this.y,2,0,Math.PI*2);ctx.fill();ctx.restore();
    }
    explode(){
      const count=randInt(36,120),baseHue=this.hue,cx=this.x,cy=this.y;
      for(let i=0;i<count;i++){
        const a=Math.random()*Math.PI*2,s=Math.random()*4+Math.random()*3;
        particles.push(new Particle(cx,cy,Math.cos(a)*s,Math.sin(a)*s,baseHue+rand(-30,30),rand(1.5,3)));
      }
      if(Math.random()<0.5)lightning.push(new Lightning(cx,cy,baseHue));
      pulseTitle(); // ðŸ”¥ Make title pulse when explosion happens
    }
  }

  class Particle {
    constructor(x,y,vx,vy,hue,size){
      this.x=x;this.y=y;this.vx=vx;this.vy=vy;this.hue=hue;this.alpha=1;
      this.size=size;this.decay=rand(0.015,0.03);
    }
    step(){
      this.vx+=WIND;this.vy+=GRAVITY;this.x+=this.vx;this.y+=this.vy;
      this.vx*=0.992;this.vy*=0.992;this.alpha-=this.decay;
      if(this.alpha<0)this.alpha=0;
    }
    draw(ctx){
      if(this.alpha<=0)return;
      ctx.save();ctx.globalCompositeOperation='lighter';
      const glowRadius=this.size*2.5;
      const g=ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,glowRadius);
      g.addColorStop(0,`hsla(${this.hue},100%,65%,${this.alpha*0.9})`);
      g.addColorStop(0.4,`hsla(${this.hue},100%,50%,${this.alpha*0.4})`);
      g.addColorStop(1,`hsla(${this.hue},100%,30%,0)`);
      ctx.fillStyle=g;
      ctx.beginPath();ctx.arc(this.x,this.y,glowRadius,0,Math.PI*2);ctx.fill();
      ctx.restore();
    }
  }

  class Lightning {
    constructor(x,y,hue){this.x=x;this.y=y;this.hue=hue;this.life=0;this.max=randInt(10,20);
      this.points=this.makeFork();}
    makeFork(){
      const seg=randInt(4,10),pts=[{x:this.x,y:this.y}],dir=Math.random()<0.5?-1:1;
      let px=this.x,py=this.y;
      for(let i=1;i<seg;i++){
        px+=rand(-15,15)+dir*rand(5,15);py+=rand(-20,-8);pts.push({x:px,y:py});
      }return pts;
    }
    step(){this.life++;}
    draw(ctx){
      const a=1-(this.life/this.max);
      ctx.save();ctx.globalCompositeOperation='lighter';ctx.lineWidth=1.5;
      ctx.beginPath();
      for(let i=0;i<this.points.length;i++){
        const p=this.points[i];
        if(i===0)ctx.moveTo(p.x,p.y);else ctx.lineTo(p.x,p.y);
      }
      ctx.strokeStyle=`hsla(${this.hue},100%,80%,${a})`;
      ctx.stroke();ctx.restore();
    }
    get done(){return this.life>this.max;}
  }

  function spawnRocket(x){rockets.push(new Rocket(x,randInt(0,360)));}
  function pulseTitle(){
    title.classList.remove('pulse');
    void title.offsetWidth; // reflow to restart animation
    title.classList.add('pulse');
  }

  function loop(){
    requestAnimationFrame(loop);
    ctx.globalCompositeOperation='source-over';
    ctx.fillStyle='rgba(0,0,6,0.25)';
    ctx.fillRect(0,0,W,H);
    if(Math.random()<0.04)spawnRocket(rand(W*0.1,W*0.9));
    for(let i=rockets.length-1;i>=0;i--){const r=rockets[i];r.step();r.draw(ctx);if(!r.alive)rockets.splice(i,1);}
    for(let i=particles.length-1;i>=0;i--){const p=particles[i];p.step();p.draw(ctx);
      if(p.alpha<=0.02||p.y>H+50)particles.splice(i,1);}
    for(let i=lightning.length-1;i>=0;i--){const L=lightning[i];L.step();L.draw(ctx);
      if(L.done)lightning.splice(i,1);}
  }

  window.addEventListener('pointerdown', e => {
    const x = e.clientX || innerWidth / 2;
    for (let i = 0; i < 4; i++) spawnRocket(x + rand(-60, 60));
    pulseTitle();
  });

  window.addEventListener('resize', () => {
    W = canvas.width = innerWidth;
    H = canvas.height = innerHeight;
  });

  loop();
})();
</script>
</body>
</html>
